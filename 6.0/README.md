<div>2016年9月20号增加 Centos 6.* 系统的rpmbuild</div><div><br /></div><div>5.*系统的rpmbuild和6.*的rpmbuild区别有以下</div><div><br /></div><div>BuildRoot: &nbsp; &nbsp; &nbsp;%_topdir/BUILDROOT</div><div><br /></div><div><br /></div><div>对于卸载之前的任务需要更改,目前还未更改，下个版本进行更改</div><div><br /></div><div>%preun</div><div>if [ $1 == 0 ];then</div><div>&nbsp; &nbsp; /etc/init.d/php-fpm stop &gt; /dev/null 2&gt;&amp;1</div><div>&nbsp; &nbsp; /sbin/chkconfig --del php-fpm</div><div>&nbsp; &nbsp; if [ -e '/etc/profile.d/custom_profile_new.sh' ];then</div><div>&nbsp; &nbsp; &nbsp; &nbsp; sed -i 's@%{_prefix}/bin:@@' /etc/profile.d/custom_profile_new.sh</div><div>&nbsp; &nbsp; else</div><div>&nbsp; &nbsp; &nbsp; &nbsp; sed -i 's@%{_prefix}/bin:@@' /etc/profile</div><div>&nbsp; &nbsp; fi</div><div>fi</div><div><br /></div><div><br /></div><div>卸载之后的执行没有对chkconfig 添加的服务进行删除，下个版本处理</div><div><br /></div><div>%postun</div><div>&nbsp; &nbsp; rm -rf %{prefix}</div><div>&nbsp; &nbsp; rm -rf /tol/app/zabbix</div><div>&nbsp; &nbsp; rm -rf /etc/init.d/zabbix_agentd</div>
